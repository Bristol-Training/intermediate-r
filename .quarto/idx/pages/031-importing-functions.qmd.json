{"title":"Importing functions","markdown":{"yaml":{"title":"Importing functions"},"headingText":"Writing your own functions","containsRefs":false,"markdown":"\n\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\nIt is likely that a lot of the R code in the vignettes you saw \nin the last page did not make sense to you now. Do not worry!\nYou are new to R and are still near the beginning of your\nlearning journey. Over the last half of this workshop we\nwill explore some of the building blocks of R so that \nthey will begin to make a little more sense ;-)\n\nA core building block of all programming languages is a\nfunction. A function is a reusable block of code that\ncan be used over and over again in your program. \nA function takes inputs (called arguments), it then \ndoes something to those inputs to produce some outputs,\nwhich are returned to you.\n\nYou've already used many functions. For example,\n\n```r\nlibrary(stringr)\nhello <- \"Hello R\"\nlength <- str_length(hello)\ncat(sprintf(\"'%s' has %d characters\\n\", hello, length)) \n```\n\nwill print `'Hello R' has 7 characters`.\n\nThis code has four functions:\n\n* `library` : This function loads the library passed as the argument,\ne.g. `library(stringr)` loads the `stringr` library\n* `str_length` : This function calculates the number of characters\nin the string passed in as the argument, returning the number of \ncharacters. When input the value of `hello` (namely `Hello R`) it\nreturns the number `7`.\n* `cat` : This prints its arguments to the screen, returning nothing.\n* `sprintf` : This formats a string based on its many input arguments,\nreturning the string that has been created.\n\n\nYou can write your own functions in R! For example, let's try to\nwrite a function that calculates the mean average of a list \nof numbers.\n\nAs input, the function will take a list of numbers. It should \noutput a number which is the mean of those numbers.\n\nThere are many ways this function could be written. Here is a \npossible solution;\n\n```r\ncalculate_mean <- function(values){\n     total <- 0.0\n     count <- 0\n     for (value in values){\n         total <- total + value\n         count <- count + 1\n     }\n     return(total / count)\n}\n```\n\nWe can then use this function, to, e.g. calculate the average\nheight of a group of people, by typing;\n\n```r\nperson_heights = c(1.62, 1.80, 1.56, 1.73, 1.91)\n\naverage_height <- calculate_mean(person_heights)\n\ncat(sprintf(\"The average height is %.2f m\\n\", average_height))\n```\n\nRunning this would print;\n\n```\nThe average height is 1.72 m\n```\n\n## Scaffolding\n\nTo explain how this worked, we need to look at how this function\nwas defined. There is some scaffolding that is common to all functions.\nFirst, we define the function name. In R, this is a variable that holds\nthe code of the function. We define this variable and assign data to\nit in the same way as if this was assigning a number to a numeric\nvariable, or a string to a string variable, namely using the\nsyntax `variable <- value`:\n\n```r\n   Variable    assigned  value \n      ↓           ↓      ↓\ncalculate_average <- function(...\n```\n\nNext, we have the keyword `function`, that says that this is some\ndata that is of type function. This means that the data will contain\ncode. The arguments to `function` are the arguments you would like\nto use as input for your new function;\n\n```r\n                     keyword  arguments\n                        ↓        ↓\ncalculate_average <- function(values) {\n```\n\nNext, you need the body of the function. This body is the lines\nof code that will be run when your function is called. Just like\nwith `for` loops or `if` statements, the body of code\nis contained within curly brackets\n\n```r\n                                  Open curly brackets\n                                      ↓\ncalculate_average <- function(values) {\n    # body of the function is the\n    # lines of code within the curly brackets\n}\n↑\nClose curly brackets\n```\n\nThe input(s) for the function is/are the argument(s) that are\npassed to `function`, in this case, `values`. \nOur code will loop through all of the values in `values` to \ncalculate the mean average. Once we have finished, we reach\nthe final part of the function, which is `return`. This is\nused to return the output of the function back to the caller.\n\n```r\n                           Input(s)\n                             ↓\ncalculate_mean <- function(values){\n     total <- 0.0\n     count <- 0\n     for (value in values){\n         total <- total + value\n         count <- count + 1\n     }\n     return(total / count)\n        ↑\n     Return output\n}\n```\n\nFinally, when we call the function, the arguments that pass\nto the function are used as the input. The output is then\nreturned and assigned to the result variable. So, in this case;\n\n```\n                Call function      with input(s)\n                        ↓             ↓  \naverage_height <- calculate_mean(person_heights)\n     ↑         ↑\n  Output     assigned\n```\n\n`calculate_mean` is called with `person_heights`. The data referred\nto by `person_heights` is passed to `calculate_mean` and in this function\nis referred to as `values`. This data is looped over, the mean average\ncalculated, resulting in an output that is returned at the end of\nthe function, and assigned to the variable `average_height`.\n\n> EXERCISE\n>\n> Write a function, called `calculate_max`, that returns the largest value.\n> Use this to find the largest height in the list of heights above.\n>\n> Hint - start by using a variable called `max_value` and setting that\n> equal to `NA`. Then use `if (is.na(max_value) || value > max_value)`\n> to test whether a `value` in `values` is greater. The `||` means \"or\"\n>\n> [Answer](functions_answer01.html)\n\n## Errors\n\nYour function works well, but what would happen if the wrong arguments\nwere passed? What should we do if someone did this?\n\n```r\nresult <- calculate_mean(c(\"cat\", \"dog\", \"horse\"))\n```\n\nIf you run this now, you will see that R prints an error;\n\n```\nError in total + value : non-numeric argument to binary operator\n```\n\nThis isn't very descriptive of helpful. You can control how R will\nbehave in an error condition by using `stop` or `warning`.\n\nYou use `stop` if you want to stop the function from continuing,\nand to print an error message for the user. For example,\nwe could use `is.numeric` to check if all of the values are\nnumeric. If not, then we could `stop`;\n\n```r\ncalculate_mean <- function(values){\n     total <- 0.0\n     count <- 0\n     for (value in values){\n         if (!is.numeric(value)){\n             stop(\"Cannot calculate average of non-numeric values\")\n         }\n         total <- total + value\n         count <- count + 1\n     }\n     return(total / count)\n}\n```\n\n(note that `!` means \"not\")\n\nNow running;\n\n```r\nresult <- calculate_mean(c(\"cat\", \"dog\", \"horse\"))\n```\n\ngives the more useful error message;\n\n```\nError in calculate_mean(c(\"cat\", \"dog\", \"horse\")) : \n  Cannot calculate average of non-numeric values\n```\n\nHowever, what if instead of stopping, we want to calculate\nthe average of any numeric values, and just warn the user \nif non-numeric values are passed? We can do this using\nthe `warning` function, e.g.\n\n```r\ncalculate_mean <- function(values){\n     total <- 0.0\n     count <- 0\n     for (value in values){\n         number <- as.numeric(value)\n\n         if (!is.na(number)){\n             total <- total + number\n             count <- count + 1\n         } else {\n             warning(\"Skipping '\", value, \n                     \"' as it is not numeric\")\n         }\n     }\n     return(total / count)\n}\n```\n\nIn this case, we try to convert the value into a number using\nthe `as.numeric` function. If this fails, it will return `NA`.\nWe then test for `NA` using the `is.na` function, printing\na warning that we are skipping this value if it isn't a number.\n\n> EXERCISE\n>\n> Add error handling to your `calculate_max` function so that\n> it warns when non-numeric values are skipped, and stops\n> when there is no maximum value (i.e. because there are\n> no numeric values passed).\n>\n> [Answer](functions_answer02.html)\n\n","srcMarkdownNoYaml":"\n\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\nIt is likely that a lot of the R code in the vignettes you saw \nin the last page did not make sense to you now. Do not worry!\nYou are new to R and are still near the beginning of your\nlearning journey. Over the last half of this workshop we\nwill explore some of the building blocks of R so that \nthey will begin to make a little more sense ;-)\n\nA core building block of all programming languages is a\nfunction. A function is a reusable block of code that\ncan be used over and over again in your program. \nA function takes inputs (called arguments), it then \ndoes something to those inputs to produce some outputs,\nwhich are returned to you.\n\nYou've already used many functions. For example,\n\n```r\nlibrary(stringr)\nhello <- \"Hello R\"\nlength <- str_length(hello)\ncat(sprintf(\"'%s' has %d characters\\n\", hello, length)) \n```\n\nwill print `'Hello R' has 7 characters`.\n\nThis code has four functions:\n\n* `library` : This function loads the library passed as the argument,\ne.g. `library(stringr)` loads the `stringr` library\n* `str_length` : This function calculates the number of characters\nin the string passed in as the argument, returning the number of \ncharacters. When input the value of `hello` (namely `Hello R`) it\nreturns the number `7`.\n* `cat` : This prints its arguments to the screen, returning nothing.\n* `sprintf` : This formats a string based on its many input arguments,\nreturning the string that has been created.\n\n## Writing your own functions\n\nYou can write your own functions in R! For example, let's try to\nwrite a function that calculates the mean average of a list \nof numbers.\n\nAs input, the function will take a list of numbers. It should \noutput a number which is the mean of those numbers.\n\nThere are many ways this function could be written. Here is a \npossible solution;\n\n```r\ncalculate_mean <- function(values){\n     total <- 0.0\n     count <- 0\n     for (value in values){\n         total <- total + value\n         count <- count + 1\n     }\n     return(total / count)\n}\n```\n\nWe can then use this function, to, e.g. calculate the average\nheight of a group of people, by typing;\n\n```r\nperson_heights = c(1.62, 1.80, 1.56, 1.73, 1.91)\n\naverage_height <- calculate_mean(person_heights)\n\ncat(sprintf(\"The average height is %.2f m\\n\", average_height))\n```\n\nRunning this would print;\n\n```\nThe average height is 1.72 m\n```\n\n## Scaffolding\n\nTo explain how this worked, we need to look at how this function\nwas defined. There is some scaffolding that is common to all functions.\nFirst, we define the function name. In R, this is a variable that holds\nthe code of the function. We define this variable and assign data to\nit in the same way as if this was assigning a number to a numeric\nvariable, or a string to a string variable, namely using the\nsyntax `variable <- value`:\n\n```r\n   Variable    assigned  value \n      ↓           ↓      ↓\ncalculate_average <- function(...\n```\n\nNext, we have the keyword `function`, that says that this is some\ndata that is of type function. This means that the data will contain\ncode. The arguments to `function` are the arguments you would like\nto use as input for your new function;\n\n```r\n                     keyword  arguments\n                        ↓        ↓\ncalculate_average <- function(values) {\n```\n\nNext, you need the body of the function. This body is the lines\nof code that will be run when your function is called. Just like\nwith `for` loops or `if` statements, the body of code\nis contained within curly brackets\n\n```r\n                                  Open curly brackets\n                                      ↓\ncalculate_average <- function(values) {\n    # body of the function is the\n    # lines of code within the curly brackets\n}\n↑\nClose curly brackets\n```\n\nThe input(s) for the function is/are the argument(s) that are\npassed to `function`, in this case, `values`. \nOur code will loop through all of the values in `values` to \ncalculate the mean average. Once we have finished, we reach\nthe final part of the function, which is `return`. This is\nused to return the output of the function back to the caller.\n\n```r\n                           Input(s)\n                             ↓\ncalculate_mean <- function(values){\n     total <- 0.0\n     count <- 0\n     for (value in values){\n         total <- total + value\n         count <- count + 1\n     }\n     return(total / count)\n        ↑\n     Return output\n}\n```\n\nFinally, when we call the function, the arguments that pass\nto the function are used as the input. The output is then\nreturned and assigned to the result variable. So, in this case;\n\n```\n                Call function      with input(s)\n                        ↓             ↓  \naverage_height <- calculate_mean(person_heights)\n     ↑         ↑\n  Output     assigned\n```\n\n`calculate_mean` is called with `person_heights`. The data referred\nto by `person_heights` is passed to `calculate_mean` and in this function\nis referred to as `values`. This data is looped over, the mean average\ncalculated, resulting in an output that is returned at the end of\nthe function, and assigned to the variable `average_height`.\n\n> EXERCISE\n>\n> Write a function, called `calculate_max`, that returns the largest value.\n> Use this to find the largest height in the list of heights above.\n>\n> Hint - start by using a variable called `max_value` and setting that\n> equal to `NA`. Then use `if (is.na(max_value) || value > max_value)`\n> to test whether a `value` in `values` is greater. The `||` means \"or\"\n>\n> [Answer](functions_answer01.html)\n\n## Errors\n\nYour function works well, but what would happen if the wrong arguments\nwere passed? What should we do if someone did this?\n\n```r\nresult <- calculate_mean(c(\"cat\", \"dog\", \"horse\"))\n```\n\nIf you run this now, you will see that R prints an error;\n\n```\nError in total + value : non-numeric argument to binary operator\n```\n\nThis isn't very descriptive of helpful. You can control how R will\nbehave in an error condition by using `stop` or `warning`.\n\nYou use `stop` if you want to stop the function from continuing,\nand to print an error message for the user. For example,\nwe could use `is.numeric` to check if all of the values are\nnumeric. If not, then we could `stop`;\n\n```r\ncalculate_mean <- function(values){\n     total <- 0.0\n     count <- 0\n     for (value in values){\n         if (!is.numeric(value)){\n             stop(\"Cannot calculate average of non-numeric values\")\n         }\n         total <- total + value\n         count <- count + 1\n     }\n     return(total / count)\n}\n```\n\n(note that `!` means \"not\")\n\nNow running;\n\n```r\nresult <- calculate_mean(c(\"cat\", \"dog\", \"horse\"))\n```\n\ngives the more useful error message;\n\n```\nError in calculate_mean(c(\"cat\", \"dog\", \"horse\")) : \n  Cannot calculate average of non-numeric values\n```\n\nHowever, what if instead of stopping, we want to calculate\nthe average of any numeric values, and just warn the user \nif non-numeric values are passed? We can do this using\nthe `warning` function, e.g.\n\n```r\ncalculate_mean <- function(values){\n     total <- 0.0\n     count <- 0\n     for (value in values){\n         number <- as.numeric(value)\n\n         if (!is.na(number)){\n             total <- total + number\n             count <- count + 1\n         } else {\n             warning(\"Skipping '\", value, \n                     \"' as it is not numeric\")\n         }\n     }\n     return(total / count)\n}\n```\n\nIn this case, we try to convert the value into a number using\nthe `as.numeric` function. If this fails, it will return `NA`.\nWe then test for `NA` using the `is.na` function, printing\na warning that we are skipping this value if it isn't a number.\n\n> EXERCISE\n>\n> Add error handling to your `calculate_max` function so that\n> it warns when non-numeric values are skipped, and stops\n> when there is no maximum value (i.e. because there are\n> no numeric values passed).\n>\n> [Answer](functions_answer02.html)\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":true,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"shift-heading-level-by":1,"highlight-style":"github","output-file":"031-importing-functions.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","theme":["cosmo","../styles.scss"],"title":"Importing functions"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}